<!DOCTYPE html>
<html lang="so">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Laam wallet - Fixed Buttons</title>
    <!-- Favicon & OG Image -->
    <link rel="icon" type="image/png" href="https://i.ibb.co/r28SP1bN/20250802-225108.png">
    <link rel="apple-touch-icon" href="https://i.ibb.co/r28SP1bN/20250802-225108.png">
    <meta property="og:image" content="https://i.ibb.co/r28SP1bN/20250802-225108.png">
    <meta property="og:title" content="Laam wallet - Modern Digital Currency">
    <meta property="og:description" content="Laam Token is a digital asset built on Stellar with a fixed supply.">
    <meta property="og:url" content="https://laam.online">
    <meta property="og:type" content="website">
<!-- Android PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1976d2">

<!-- iPhone / iPad PWA -->
<link rel="apple-touch-icon" href="https://i.ibb.co/r28SP1bN/20250802-225108.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Laam Wallet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/stellar-sdk/10.4.0/stellar-sdk.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
<style>
  :root{
    /* Blue & White Theme */
    --bg1:#eef2f3; --bg2:#8e9eab;
    --card:rgba(255, 255, 255, 0.9);
    --text:#0a192f; --muted:#546e7a;
    --brand:#0052cc; --brand2:#0041a3; --line:#d0d8e0;
    --ok:#28a745; --warn:#ffc107; --err:#dc3545;
    --maxw: 920px; --rad:16px;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
    color:var(--text);
    background:linear-gradient(135deg,#b8c6db,#f5f7fa);
    min-height:100vh; display:flex; align-items:center; justify-content:center; padding:24px 14px;
  }
  .app{ width:100%; max-width:450px; text-align:center; }
  
  /* Logo and Header Styles */
  .logo-container{ 
    display:flex; 
    align-items:center; 
    justify-content:center; 
    gap:15px; 
    margin-bottom:40px; 
  }
  .logo-container img{ 
    width:80px; 
    height:80px; 
    border-radius:50%;
    box-shadow:0 4px 12px rgba(0,0,0,0.1);
  }
  h1{ 
    margin:0; 
    font-size:3rem; 
    font-weight:800; 
    color:#1976d2; 
    text-shadow:1px 1px 2px rgba(0,0,0,0.1); 
  }
  
  /* Import Card Styles */
  .import-card{
    background:rgba(255, 255, 255, 0.95);
    border:none;
    border-radius:24px;
    box-shadow:0 8px 32px rgba(0,0,0,0.12);
    padding:40px 30px;
    margin:0 auto;
    backdrop-filter:blur(10px);
    max-width:100%;
  }
  
  .form-group{
    margin-bottom:24px;
    text-align:left;
  }
  
  .form-label{
    display:block;
    font-size:18px;
    font-weight:700;
    color:#1976d2;
    margin-bottom:12px;
  }
  
  .form-input{
    width:100%;
    padding:20px;
    border:2px solid #e0e0e0;
    border-radius:16px;
    font-size:16px;
    background:#f8f9fa;
    color:#333;
    outline:none;
    transition:all 0.3s ease;
    font-family:'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
  }
  
  .form-input:focus{
    border-color:#1976d2;
    background:white;
    box-shadow:0 0 0 4px rgba(25,118,210,0.1);
  }
  
  .form-input::placeholder{
    color:#bbb;
    font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
  }
  
  .import-button{
    width:100%;
    padding:20px;
    background:#1976d2;
    color:white;
    border:none;
    border-radius:16px;
    font-size:18px;
    font-weight:700;
    text-transform:uppercase;
    letter-spacing:1px;
    cursor:pointer;
    transition:all 0.3s ease;
    box-shadow:0 4px 16px rgba(25,118,210,0.3);
    margin-top:16px;
  }
  
  .import-button:hover{
    background:#1565c0;
    box-shadow:0 6px 20px rgba(25,118,210,0.4);
    transform:translateY(-2px);
  }
  
  .divider{
    margin:32px 0;
    text-align:center;
    position:relative;
  }
  
  .divider::before{
    content:'';
    position:absolute;
    top:50%;
    left:0;
    right:0;
    height:1px;
    background:#e0e0e0;
  }
  
  .divider-text{
    background:rgba(255, 255, 255, 0.95);
    padding:0 16px;
    color:#666;
    font-size:14px;
    font-weight:500;
  }
  
  .generate-link{
    text-align:center;
  }
  
  .generate-button{
    color:#1976d2;
    text-decoration:underline;
    background:none;
    border:none;
    cursor:pointer;
    font-size:16px;
    font-weight:600;
    transition:color 0.3s ease;
    text-transform:none;
    padding:0;
    width:auto;
    box-shadow:none;
  }
  
  .generate-button:hover{
    color:#1565c0;
    transform:none;
    box-shadow:none;
  }
  .note-text{
    font-size:12px;
    color:#666;
    margin-top:8px;
    line-height:1.4;
  }

  /* Key Display Modal */
  .key-modal{
    display:none;
    position:fixed;
    inset:0;
    width:100%;
    height:100%;
    background:rgba(0,0,0,0.5);
    z-index:1000;
    align-items:center;
    justify-content:center;
  }
  .key-modal.show{
    display:flex;
  }
  .key-modal-content{
    background:rgba(255, 255, 255, 0.95);
    border:none;
    border-radius:24px;
    box-shadow:0 8px 32px rgba(0,0,0,0.12);
    padding:40px 30px;
    max-width:500px;
    width:90%;
    max-height:90vh;
    overflow-y:auto;
    backdrop-filter:blur(10px);
  }
  .key-modal-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:30px;
  }
  .key-modal-title{
    font-size:1.8rem;
    font-weight:700;
    color:#1976d2;
    margin:0;
  }
  .key-modal-close{
    background:none;
    border:none;
    font-size:2rem;
    cursor:pointer;
    color:#666;
    padding:0;
    width:auto;
    height:auto;
    box-shadow:none;
    text-transform:none;
  }
  .key-modal-close:hover{
    color:#333;
    transform:none;
    box-shadow:none;
  }
  .key-display-group{
    margin-bottom:30px;
  }
  .key-display-label{
    display:block;
    font-size:16px;
    font-weight:700;
    color:#1976d2;
    margin-bottom:12px;
  }
  .key-display-container{
    position:relative;
    display:flex;
    align-items:center;
  }
  .key-display-input{
    width:100%;
    padding:15px 60px 15px 15px;
    border:2px solid #e0e0e0;
    border-radius:12px;
    font-size:14px;
    background:#f8f9fa;
    color:#333;
    font-family:'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
    word-break:break-all;
    resize:none;
  }
  .copy-btn{
    position:absolute;
    right:10px;
    background:#1976d2;
    color:white;
    border:none;
    border-radius:8px;
    padding:8px 12px;
    font-size:12px;
    font-weight:600;
    cursor:pointer;
    transition:all 0.3s ease;
    text-transform:uppercase;
    box-shadow:0 2px 8px rgba(25,118,210,0.3);
  }
  .copy-btn:hover{
    background:#1565c0;
    box-shadow:0 4px 12px rgba(25,118,210,0.4);
    transform:translateY(-1px);
  }
  .copy-btn.copied{
    background:#28a745;
    box-shadow:0 2px 8px rgba(40,167,69,0.3);
  }
  .warning-text{
    background:#fff3cd;
    border:1px solid #ffeaa7;
    border-radius:12px;
    padding:15px;
    margin:20px 0;
    color:#856404;
    font-size:14px;
    line-height:1.5;
  }
  .use-account-btn{
    width:100%;
    padding:15px;
    background:#28a745;
    color:white;
    border:none;
    border-radius:12px;
    font-size:16px;
    font-weight:700;
    text-transform:uppercase;
    cursor:pointer;
    transition:all 0.3s ease;
    box-shadow:0 4px 16px rgba(40,167,69,0.3);
  }
  .use-account-btn:hover{
    background:#218838;
    box-shadow:0 6px 20px rgba(40,167,69,0.4);
    transform:translateY(-2px);
  }

  .hidden{ display:none; }
  .custom-alert {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: #28a745;
    color: white;
    padding: 14px 22px;
    border-radius: 12px;
    font-weight: 600;
    box-shadow: 0 4px 12px rgba(0,0,0,0.25);
    z-index: 9999;
    display: none;
    animation: fadeInUp 0.4s ease;
  }
  @keyframes fadeInUp {
    from { opacity: 0; transform: translate(-50%, 20px); }
    to { opacity: 1; transform: translate(-50%, 0); }
  }

  @media (max-width: 480px) {
    .app {
      max-width: 100%;
      padding: 0 10px;
    }
    
    .import-card {
      padding: 30px 20px;
      margin: 10px;
    }
    
    .logo-container img {
      width: 60px;
      height: 60px;
    }
    
    h1 {
      font-size: 2.2rem;
    }

    .key-modal-content {
      padding: 30px 20px;
      margin: 10px;
    }

    .key-display-input {
      font-size: 12px;
      padding: 12px 50px 12px 12px;
    }

    .copy-btn {
      padding: 6px 8px;
      font-size: 10px;
    }
  }
</style>
</head>
<body>
  <div class="app">
    <div class="logo-container">
      <img src="https://i.ibb.co/r28SP1bN/20250802-225108.png" alt="Laam Logo">
      <h1>Laam wallet</h1>
    </div>

    <!-- AUTH SECTION -->
    <div id="authSection">
      <div class="import-card">
        <div id="unlockView" class="hidden">
          <h3 style="margin:0 0 20px 0; color:#1976d2; text-align:center; font-size:1.5rem;">Unlock Wallet</h3>
          <div class="form-group">
            <label class="form-label" for="walletPassword">Password</label>
            <input class="form-input" id="walletPassword" type="password" placeholder="Enter your password" />
          </div>
          <button class="import-button" id="unlockBtn">Unlock</button>
          <div class="divider">
            <span class="divider-text">or</span>
          </div>
          <div class="generate-link">
            <a href="#" id="resetWalletLink" style="color:#1976d2; text-decoration:none;">Reset and Import New Key</a>
          </div>
        </div>

        <div id="initialView">
          <div class="form-group">
            <label class="form-label" for="secretKeyInput">Secret Key (S...)</label>
            <input class="form-input" id="secretKeyInput" type="password" placeholder="SXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"/>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="savePasswordInput">Create Password to Save</label>
            <input class="form-input" id="savePasswordInput" type="password" placeholder="Min 8 chars"/>
          </div>
          
          <button class="import-button" id="importAndSaveBtn">Import wallet and Save</button>
          
          <div class="divider">
            <span class="divider-text">or</span>
          </div>
          
          <div class="generate-link">
            <button class="generate-button" id="generateAccountBtn">Create new wallet</button>
            <p class="note-text">(Remember: You must deposit at least 4 XLM into your wallet for it to be activated.)</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Key Display Modal -->
    <div id="keyModal" class="key-modal">
      <div class="key-modal-content">
        <div class="key-modal-header">
          <h3 class="key-modal-title">New Wallet Account Generated</h3>
          <button class="key-modal-close" onclick="closeKeyModal()">&times;</button>
        </div>
        
        <div class="key-display-group">
          <label class="key-display-label">Secret Key (S...)</label>
          <div class="key-display-container">
            <textarea class="key-display-input" id="generatedSecretKey" readonly rows="3"></textarea>
            <button class="copy-btn" onclick="copyToClipboard('generatedSecretKey', this)">Copy</button>
          </div>
        </div>

        <div class="key-display-group">
          <label class="key-display-label">Public Key (G...)</label>
          <div class="key-display-container">
            <textarea class="key-display-input" id="generatedPublicKey" readonly rows="2"></textarea>
            <button class="copy-btn" onclick="copyToClipboard('generatedPublicKey', this)">Copy</button>
          </div>
        </div>

        <div class="warning-text">
          <strong>⚠️IMPORTANT</strong> Save your Secret Key in a secure place! You will need it to access your wallet. If you lose it, you will not be able to recover your account. Also, copy your public key and fund it with at least 4 XLM to activate your wallet.
        </div>

        <button class="use-account-btn" onclick="useGeneratedAccount()">Use This Account</button>
      </div>
    </div>

    <!-- LOGGED IN VIEW -->
    <div id="loggedInView" class="hidden">
      <!-- Wallet content would go here -->
      <div class="import-card">
        <h3 style="margin:0 0 20px 0; color:#1976d2; text-align:center;">Wallet Loaded Successfully</h3>
        <p>Your wallet has been successfully loaded. You can now send and receive funds.</p>
        <button class="import-button" id="logoutBtn">Logout</button>
      </div>
    </div>
  </div>

  <div id="successAlert" class="custom-alert">Operation completed successfully</div>

  <script>
    // Laam token configuration
    const LAAM_TOKEN = {
      code: "Laam",
      issuer: "GAL4ECDAXNBMJYFCWIJ32HKVIRLCNEXY664CAZYI3EINQWPLXTMEPR64"
    };

    // Global variables
    let currentKeypair = null;
    let server = null;
    let generatedKeypair = null;
    
    // Initialize Stellar SDK
    function initializeStellar() {
      try {
        if (typeof StellarSdk !== 'undefined') {
          server = new StellarSdk.Server('https://horizon.stellar.org');
          console.log('Stellar SDK initialized successfully');
        } else {
          console.error('Stellar SDK not loaded');
          showError('Stellar SDK failed to load. Please refresh the page.');
        }
      } catch (error) {
        console.error('Error initializing Stellar SDK:', error);
        showError('Failed to initialize Stellar SDK: ' + error.message);
      }
    }
    
    // Utility functions
    function showError(message) {
      alert('Error: ' + message);
    }
    
    function showSuccess(message) {
      const alertBox = document.getElementById("successAlert");
      alertBox.textContent = message;
      alertBox.style.display = "block";
      setTimeout(() => {
        alertBox.style.display = "none";
      }, 3000);
    }
    
    function encryptSecretKey(secretKey, password) {
      return CryptoJS.AES.encrypt(secretKey, password).toString();
    }
    
    function decryptSecretKey(encryptedKey, password) {
      try {
        const bytes = CryptoJS.AES.decrypt(encryptedKey, password);
        return bytes.toString(CryptoJS.enc.Utf8);
      } catch (e) {
        return null;
      }
    }

    // Copy to clipboard function
    async function copyToClipboard(elementId, buttonElement) {
      try {
        const element = document.getElementById(elementId);
        const text = element.value;
        
        await navigator.clipboard.writeText(text);
        
        const originalText = buttonElement.textContent;
        buttonElement.textContent = 'Copied!';
        buttonElement.classList.add('copied');
        
        setTimeout(() => {
          buttonElement.textContent = originalText;
          buttonElement.classList.remove('copied');
        }, 2000);
        
      } catch (err) {
        console.error('Failed to copy:', err);
        const element = document.getElementById(elementId);
        element.select();
        element.setSelectionRange(0, 99999);
        document.execCommand('copy');
        
        const originalText = buttonElement.textContent;
        buttonElement.textContent = 'Copied!';
        buttonElement.classList.add('copied');
        
        setTimeout(() => {
          buttonElement.textContent = originalText;
          buttonElement.classList.remove('copied');
        }, 2000);
      }
    }

    // Key modal functions
    function openKeyModal(secretKey, publicKey) {
      document.getElementById('generatedSecretKey').value = secretKey;
      document.getElementById('generatedPublicKey').value = publicKey;
      document.getElementById('keyModal').classList.add('show');
    }

    function closeKeyModal() {
      document.getElementById('keyModal').classList.remove('show');
      generatedKeypair = null;
    }

    function useGeneratedAccount() {
      if (generatedKeypair) {
        document.getElementById('secretKeyInput').value = generatedKeypair.secret();
        closeKeyModal();
        showSuccess('Account keys have been filled in the form. Please create a password to save your wallet.');
      }
    }

    // Check if wallet exists in localStorage
    function checkSavedWallet() {
      const encryptedKey = localStorage.getItem('laam_wallet_key');
      if (encryptedKey) {
        document.getElementById('initialView').classList.add('hidden');
        document.getElementById('unlockView').classList.remove('hidden');
      }
    }

    // Initialize when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
      console.log('DOM loaded, initializing...');
      
      initializeStellar();
      
      if (typeof StellarSdk === 'undefined') {
        console.error('StellarSdk is not defined');
        showError('Stellar SDK failed to load. Please refresh the page.');
        return;
      }
      
      if (typeof CryptoJS === 'undefined') {
        console.error('CryptoJS is not defined');
        showError('CryptoJS failed to load. Please refresh the page.');
        return;
      }
      
      console.log('All libraries loaded successfully');
      
      checkSavedWallet();
      
      // Import wallet button event listener
      document.getElementById('importAndSaveBtn').addEventListener('click', async function(e) {
        e.preventDefault();
        console.log('Import button clicked');
        
        const secretKey = document.getElementById('secretKeyInput').value.trim();
        const password = document.getElementById('savePasswordInput').value;
        
        console.log('Secret key length:', secretKey.length);
        console.log('Password length:', password.length);
        
        if (!secretKey.startsWith('S') || secretKey.length !== 56) {
          showError('Invalid secret key format. Secret key should start with S and be 56 characters long.');
          return;
        }
        
        if (password.length < 8) {
          showError('Password must be at least 8 characters long.');
          return;
        }
        
        this.textContent = 'Importing...';
        this.disabled = true;
        
        try {
          console.log('Validating secret key...');
          currentKeypair = StellarSdk.Keypair.fromSecret(secretKey);
          console.log('Secret key validated successfully');
          
          console.log('Encrypting and saving...');
          const encryptedKey = encryptSecretKey(secretKey, password);
          localStorage.setItem('laam_wallet_key', encryptedKey);
          localStorage.setItem('laam_wallet_public', currentKeypair.publicKey());
          console.log('Wallet saved successfully');
          
          showSuccess('Wallet imported successfully!');
          document.getElementById('authSection').classList.add('hidden');
          document.getElementById('loggedInView').classList.remove('hidden');
          
        } catch (error) {
          console.error('Import error:', error);
          showError('Failed to import wallet: ' + error.message);
        } finally {
          this.textContent = 'Import and Save';
          this.disabled = false;
        }
      });
      
      // Generate account button event listener
      document.getElementById('generateAccountBtn').addEventListener('click', function() {
        console.log('Generate account button clicked');
        
        try {
          generatedKeypair = StellarSdk.Keypair.random();
          const secretKey = generatedKeypair.secret();
          const publicKey = generatedKeypair.publicKey();
                 
          console.log('New keypair generated successfully');
          
          openKeyModal(secretKey, publicKey);
          
        } catch (error) {
          console.error('Generate account error:', error);
          showError('Failed to generate account: ' + error.message);
        }
      });
      
      // Unlock wallet button event listener
      document.getElementById('unlockBtn').addEventListener('click', async function() {
        const password = document.getElementById('walletPassword').value;
        const encryptedKey = localStorage.getItem('laam_wallet_key');
        
        if (!encryptedKey) {
          showError('No wallet found. Please import a wallet first.');
          return;
        }
        
        if (!password) {
          showError('Please enter your password.');
          return;
        }
        
        this.textContent = 'Unlocking...';
        this.disabled = true;
        
        try {
          const decryptedKey = decryptSecretKey(encryptedKey, password);
          
          if (!decryptedKey) {
            showError('Incorrect password.');
            return;
          }
          
          currentKeypair = StellarSdk.Keypair.fromSecret(decryptedKey);
          
          showSuccess('Wallet unlocked successfully!');
          document.getElementById('authSection').classList.add('hidden');
          document.getElementById('loggedInView').classList.remove('hidden');
          
        } catch (error) {
          console.error('Unlock error:', error);
          showError('Failed to unlock wallet: ' + error.message);
        } finally {
          this.textContent = 'Unlock';
          this.disabled = false;
        }
      });
      
      // Reset wallet link event listener
      document.getElementById('resetWalletLink').addEventListener('click', function(e) {
        e.preventDefault();
        
        if (confirm('This will remove your saved wallet. Are you sure?')) {
          localStorage.removeItem('laam_wallet_key');
          localStorage.removeItem('laam_wallet_public');
          
          document.getElementById('unlockView').classList.add('hidden');
          document.getElementById('initialView').classList.remove('hidden');
          
          showSuccess('Wallet reset successfully.');
        }
      });
      
      // Logout button event listener
      document.getElementById('logoutBtn').addEventListener('click', function() {
        currentKeypair = null;
        
        document.getElementById('loggedInView').classList.add('hidden');
        document.getElementById('authSection').classList.remove('hidden');
        
        const encryptedKey = localStorage.getItem('laam_wallet_key');
        if (encryptedKey) {
          document.getElementById('initialView').classList.add('hidden');
          document.getElementById('unlockView').classList.remove('hidden');
        } else {
          document.getElementById('unlockView').classList.add('hidden');
          document.getElementById('initialView').classList.remove('hidden');
        }
      });
      
      console.log('All event listeners attached successfully');
    });
  </script>
</body>
</html>
 
